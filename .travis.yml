notifications:
  email:
    on_success: change
language: python
os: linux
# python:
#   - "3.6"
#   - "3.7"
# script: pytest

jobs:
  include:

    - stage: "pip package test"
      branches:
        only:
          - master
      python: "3.8"
      install:
        - pip install -r requirements.txt
        - pip install .
      script:
        - python integration/rdf.py

    - stage: "Unit tests"
      name: "3.6"
      branches:
        only:
          - master
      python: "3.6"
      install:
        - pip install -r requirements.txt
      script:
        - /bin/bash ci/unit_tests/run_unit_tests.bash
    
    - name: "3.7"
      branches:
        only:
          - master
      python: "3.7"
      install:
        - pip install -r requirements.txt
      script:
        - /bin/bash ci/unit_tests/run_unit_tests.bash

    - name: "3.8"
      branches:
        only:
          - master
      python: "3.8"
      install:
        - pip install -r requirements.txt
      script:
        - /bin/bash ci/unit_tests/run_unit_tests.bash


    - stage: "integration test"
      name: "integration 3.6"
      env:
        - PYTHONPATH=$(pwd)
      branches:
        only:
          - master
      python: "3.6"
      install:
        - pip install -r requirements.txt
        - pip install .
        - /bin/bash ci/start_weaviate.bash
      script:
        - python integration/client_functions.py
        - python integration/rdf.py

#    - stage: "Build documentation"
#      language: python
#      python:
#        - "3.7"
#      notifications:
#        email:
#          on_success: change
#      branches:
#        only:
#          # Set the documentation only to master and push all the documentation updates to documentation branch
#          - master
#      install:
#        - pip install sphinx
#      script:
#        - /bin/bash ci/generate_doc.bash
