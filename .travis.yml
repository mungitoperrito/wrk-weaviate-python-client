notifications:
  email:
    on_success: change
language: python

branches:
  only:
    - master

jobs:
  include:
    - stage: "Unit tests"
      name: "Unit tests on python 3.6"
      python: "3.6"
      install:
        - pip install -r requirements.txt
      script:
        - python -m unittest -v
    
    - name: "Unit tests on python 3.7"
      python: "3.7"
      install:
        - pip install -r requirements.txt
      script:
        - python -m unittest -v

    - name: "Unit tests on python 3.8"
      python: "3.8"
      install:
        - pip install -r requirements.txt
      script:
        - python -m unittest -v

    - name: "Unit tests on python 3.9"
      python: "3.9"
      install:
        - pip install -r requirements.txt
      script:
        - python -m unittest -v


    - stage: "integration test"
      name: "integration 3.6"
      env:
        - PYTHONPATH=$(pwd)
      python: "3.6"
      install:
        - pip install -r requirements.txt
        - pip install .
        - /bin/bash ci/start_weaviate.bash
      script:
        - python integration/client_functions.py
        - python integration/rdf.py

    - name: "pip package test"
      # Test if pip package throws any errors when importing
      python: "3.8"
      install:
        - pip install -r requirements.txt
        - pip install .
      script:
        - python integration/pip_package.py

#    - stage: "Build documentation"
#      language: python
#      python:
#        - "3.7"
#      notifications:
#        email:
#          on_success: change
#      branches:
#        only:
#          # Set the documentation only to master and push all the documentation updates to documentation branch
#          - master
#      install:
#        - pip install sphinx
#      script:
#        - /bin/bash ci/generate_doc.bash
